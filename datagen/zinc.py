# these are ZINC tranches for MW < 500 (from https://zinc20.docking.org/tranches/home/)
import numpy as np
import requests


ZINC_TRANCHES = "AAAA AAAB AAAC AAAD AABA AABB AABC AABD AACA AACB AACC AACD AAEA AAEB AAEC AAED BAAA BAAB BAAC BAAD BABA BABB BABC BABD BACA BACB BACC BACD BAEA BAEB BAEC BAED CAAA CAAB CAAC CAAD CABA CABB CABC CABD CACA CACB CACC CACD CAEA CAEB CAEC CAED DAAA DAAB DAAC DAAD DABA DABB DABC DABD DACA DACB DACC DACD DAEA DAEB DAEC DAED EAAA EAAB EAAC EAAD EABA EABB EABC EABD EACA EACB EACC EACD EAEA EAEB EAEC EAED FAAA FAAB FAAC FAAD FABA FABB FABC FABD FACA FACB FACC FACD FAEA FAEB FAEC FAED GAAA GAAB GAAC GAAD GABA GABB GABC GABD GACA GACB GACC GACD GAEA GAEB GAEC GAED HAAA HAAB HAAC HAAD HABA HABB HABC HABD HACA HACB HACC HACD HAEA HAEB HAEC HAED IAAA IAAB IAAC IAAD IABA IABB IABC IABD IACA IACB IACC IACD IAEA IAEB IAEC IAED JAAA JAAB JAAC JAAD JABA JABB JABC JABD JACA JACB JACC JACD JAEA JAEB JAEC JAED ABAA ABAB ABAC ABAD ABBA ABBB ABBC ABBD ABCA ABCB ABCC ABCD ABEA ABEB ABEC ABED BBAA BBAB BBAC BBAD BBBA BBBB BBBC BBBD BBCA BBCB BBCC BBCD BBEA BBEB BBEC BBED CBAA CBAB CBAC CBAD CBBA CBBB CBBC CBBD CBCA CBCB CBCC CBCD CBEA CBEB CBEC CBED DBAA DBAB DBAC DBAD DBBA DBBB DBBC DBBD DBCA DBCB DBCC DBCD DBEA DBEB DBEC DBED EBAA EBAB EBAC EBAD EBBA EBBB EBBC EBBD EBCA EBCB EBCC EBCD EBEA EBEB EBEC EBED FBAA FBAB FBAC FBAD FBBA FBBB FBBC FBBD FBCA FBCB FBCC FBCD FBEA FBEB FBEC FBED GBAA GBAB GBAC GBAD GBBA GBBB GBBC GBBD GBCA GBCB GBCC GBCD GBEA GBEB GBEC GBED HBAA HBAB HBAC HBAD HBBA HBBB HBBC HBBD HBCA HBCB HBCC HBCD HBEA HBEB HBEC HBED IBAA IBAB IBAC IBAD IBBA IBBB IBBC IBBD IBCA IBCB IBCC IBCD IBEA IBEB IBEC IBED JBAA JBAB JBAC JBAD JBBA JBBB JBBC JBBD JBCA JBCB JBCC JBCD JBEA JBEB JBEC JBED ACAA ACAB ACAC ACAD ACBA ACBB ACBC ACBD ACCA ACCB ACCC ACCD ACEA ACEB ACEC ACED BCAA BCAB BCAC BCAD BCBA BCBB BCBC BCBD BCCA BCCB BCCC BCCD BCEA BCEB BCEC BCED CCAA CCAB CCAC CCAD CCBA CCBB CCBC CCBD CCCA CCCB CCCC CCCD CCEA CCEB CCEC CCED DCAA DCAB DCAC DCAD DCBA DCBB DCBC DCBD DCCA DCCB DCCC DCCD DCEA DCEB DCEC DCED ECAA ECAB ECAC ECAD ECBA ECBB ECBC ECBD ECCA ECCB ECCC ECCD ECEA ECEB ECEC ECED FCAA FCAB FCAC FCAD FCBA FCBB FCBC FCBD FCCA FCCB FCCC FCCD FCEA FCEB FCEC FCED GCAA GCAB GCAC GCAD GCBA GCBB GCBC GCBD GCCA GCCB GCCC GCCD GCEA GCEB GCEC GCED HCAA HCAB HCAC HCAD HCBA HCBB HCBC HCBD HCCA HCCB HCCC HCCD HCEA HCEB HCEC HCED ICAA ICAB ICAC ICAD ICBA ICBB ICBC ICBD ICCA ICCB ICCC ICCD ICEA ICEB ICEC ICED JCAA JCAB JCAC JCAD JCBA JCBB JCBC JCBD JCCA JCCB JCCC JCCD JCEA JCEB JCEC JCED ADAA ADAB ADAC ADAD ADBA ADBB ADBC ADBD ADCA ADCB ADCC ADCD ADEA ADEB ADEC ADED BDAA BDAB BDAC BDAD BDBA BDBB BDBC BDBD BDCA BDCB BDCC BDCD BDEA BDEB BDEC BDED CDAA CDAB CDAC CDAD CDBA CDBB CDBC CDBD CDCA CDCB CDCC CDCD CDEA CDEB CDEC CDED DDAA DDAB DDAC DDAD DDBA DDBB DDBC DDBD DDCA DDCB DDCC DDCD DDEA DDEB DDEC DDED EDAA EDAB EDAC EDAD EDBA EDBB EDBC EDBD EDCA EDCB EDCC EDCD EDEA EDEB EDEC EDED FDAA FDAB FDAC FDAD FDBA FDBB FDBC FDBD FDCA FDCB FDCC FDCD FDEA FDEB FDEC FDED GDAA GDAB GDAC GDAD GDBA GDBB GDBC GDBD GDCA GDCB GDCC GDCD GDEA GDEB GDEC GDED HDAA HDAB HDAC HDAD HDBA HDBB HDBC HDBD HDCA HDCB HDCC HDCD HDEA HDEB HDEC HDED IDAA IDAB IDAC IDAD IDBA IDBB IDBC IDBD IDCA IDCB IDCC IDCD IDEA IDEB IDEC IDED JDAA JDAB JDAC JDAD JDBA JDBB JDBC JDBD JDCA JDCB JDCC JDCD JDEA JDEB JDEC JDED AEAA AEAB AEAC AEAD AEBA AEBB AEBC AEBD AECA AECB AECC AECD AEEA AEEB AEEC AEED BEAA BEAB BEAC BEAD BEBA BEBB BEBC BEBD BECA BECB BECC BECD BEEA BEEB BEEC BEED CEAA CEAB CEAC CEAD CEBA CEBB CEBC CEBD CECA CECB CECC CECD CEEA CEEB CEEC CEED DEAA DEAB DEAC DEAD DEBA DEBB DEBC DEBD DECA DECB DECC DECD DEEA DEEB DEEC DEED EEAA EEAB EEAC EEAD EEBA EEBB EEBC EEBD EECA EECB EECC EECD EEEA EEEB EEEC EEED FEAA FEAB FEAC FEAD FEBA FEBB FEBC FEBD FECA FECB FECC FECD FEEA FEEB FEEC FEED GEAA GEAB GEAC GEAD GEBA GEBB GEBC GEBD GECA GECB GECC GECD GEEA GEEB GEEC GEED HEAA HEAB HEAC HEAD HEBA HEBB HEBC HEBD HECA HECB HECC HECD HEEA HEEB HEEC HEED IEAA IEAB IEAC IEAD IEBA IEBB IEBC IEBD IECA IECB IECC IECD IEEA IEEB IEEC IEED JEAA JEAB JEAC JEAD JEBA JEBB JEBC JEBD JECA JECB JECC JECD JEEA JEEB JEEC JEED AFAA AFAB AFAC AFAD AFBA AFBB AFBC AFBD AFCA AFCB AFCC AFCD AFEA AFEB AFEC AFED BFAA BFAB BFAC BFAD BFBA BFBB BFBC BFBD BFCA BFCB BFCC BFCD BFEA BFEB BFEC BFED CFAA CFAB CFAC CFAD CFBA CFBB CFBC CFBD CFCA CFCB CFCC CFCD CFEA CFEB CFEC CFED DFAA DFAB DFAC DFAD DFBA DFBB DFBC DFBD DFCA DFCB DFCC DFCD DFEA DFEB DFEC DFED EFAA EFAB EFAC EFAD EFBA EFBB EFBC EFBD EFCA EFCB EFCC EFCD EFEA EFEB EFEC EFED FFAA FFAB FFAC FFAD FFBA FFBB FFBC FFBD FFCA FFCB FFCC FFCD FFEA FFEB FFEC FFED GFAA GFAB GFAC GFAD GFBA GFBB GFBC GFBD GFCA GFCB GFCC GFCD GFEA GFEB GFEC GFED HFAA HFAB HFAC HFAD HFBA HFBB HFBC HFBD HFCA HFCB HFCC HFCD HFEA HFEB HFEC HFED IFAA IFAB IFAC IFAD IFBA IFBB IFBC IFBD IFCA IFCB IFCC IFCD IFEA IFEB IFEC IFED JFAA JFAB JFAC JFAD JFBA JFBB JFBC JFBD JFCA JFCB JFCC JFCD JFEA JFEB JFEC JFED AGAA AGAB AGAC AGAD AGBA AGBB AGBC AGBD AGCA AGCB AGCC AGCD AGEA AGEB AGEC AGED BGAA BGAB BGAC BGAD BGBA BGBB BGBC BGBD BGCA BGCB BGCC BGCD BGEA BGEB BGEC BGED CGAA CGAB CGAC CGAD CGBA CGBB CGBC CGBD CGCA CGCB CGCC CGCD CGEA CGEB CGEC CGED DGAA DGAB DGAC DGAD DGBA DGBB DGBC DGBD DGCA DGCB DGCC DGCD DGEA DGEB DGEC DGED EGAA EGAB EGAC EGAD EGBA EGBB EGBC EGBD EGCA EGCB EGCC EGCD EGEA EGEB EGEC EGED FGAA FGAB FGAC FGAD FGBA FGBB FGBC FGBD FGCA FGCB FGCC FGCD FGEA FGEB FGEC FGED GGAA GGAB GGAC GGAD GGBA GGBB GGBC GGBD GGCA GGCB GGCC GGCD GGEA GGEB GGEC GGED HGAA HGAB HGAC HGAD HGBA HGBB HGBC HGBD HGCA HGCB HGCC HGCD HGEA HGEB HGEC HGED IGAA IGAB IGAC IGAD IGBA IGBB IGBC IGBD IGCA IGCB IGCC IGCD IGEA IGEB IGEC IGED JGAA JGAB JGAC JGAD JGBA JGBB JGBC JGBD JGCA JGCB JGCC JGCD JGEA JGEB JGEC JGED AHAA AHAB AHAC AHAD AHBA AHBB AHBC AHCA AHCB AHCC AHCD AHEA AHEB AHEC AHED BHAA BHAB BHAC BHAD BHBA BHBB BHBC BHBD BHCA BHCB BHCC BHCD BHEA BHEB BHEC BHED CHAA CHAB CHAC CHAD CHBA CHBB CHBC CHBD CHCA CHCB CHCC CHCD CHEA CHEB CHEC CHED DHAA DHAB DHAC DHAD DHBA DHBB DHBC DHBD DHCA DHCB DHCC DHCD DHEA DHEB DHEC DHED EHAA EHAB EHAC EHAD EHBA EHBB EHBC EHBD EHCA EHCB EHCC EHCD EHEA EHEB EHEC EHED FHAA FHAB FHAC FHAD FHBA FHBB FHBC FHBD FHCA FHCB FHCC FHCD FHEA FHEB FHEC FHED GHAA GHAB GHAC GHAD GHBA GHBB GHBC GHBD GHCA GHCB GHCC GHCD GHEA GHEB GHEC GHED HHAA HHAB HHAC HHAD HHBA HHBB HHBC HHBD HHCA HHCB HHCC HHCD HHEA HHEB HHEC HHED IHAA IHAB IHAC IHAD IHBA IHBB IHBC IHBD IHCA IHCB IHCC IHCD IHEA IHEB IHEC IHED JHAA JHAB JHAC JHAD JHBA JHBB JHBC JHBD JHCA JHCB JHCC JHCD JHEA JHEB JHEC JHED AIAA AIAB AIAC AIAD AIBA AIBB AIBC AIBD AICA AICB AIEA AIEB AIEC AIED BIAA BIAB BIAC BIAD BIBA BIBB BIBC BIBD BICA BICB BICC BICD BIEA BIEB BIEC BIED CIAA CIAB CIAC CIAD CIBA CIBB CIBC CIBD CICA CICB CICC CICD CIEA CIEB CIEC CIED DIAA DIAB DIAC DIAD DIBA DIBB DIBC DIBD DICA DICB DICC DICD DIEA DIEB DIEC DIED EIAA EIAB EIAC EIAD EIBA EIBB EIBC EIBD EICA EICB EICC EICD EIEA EIEB EIEC EIED FIAA FIAB FIAC FIAD FIBA FIBB FIBC FIBD FICA FICB FICC FICD FIEA FIEB FIEC FIED GIAA GIAB GIAC GIAD GIBA GIBB GIBC GIBD GICA GICB GICC GICD GIEA GIEB GIEC GIED HIAA HIAB HIAC HIAD HIBA HIBB HIBC HIBD HICA HICB HICC HICD HIEA HIEB HIEC HIED IIAA IIAB IIAC IIAD IIBA IIBB IIBC IIBD IICA IICB IICC IICD IIEA IIEB IIEC IIED JIAA JIAB JIAC JIAD JIBA JIBB JIBC JIBD JICA JICB JICC JICD JIEA JIEB JIEC JIED AJAA AJAB AJAC AJAD AJEA AJEB AJEC AJED BJAA BJAB BJAC BJAD BJBA BJBB BJBC BJBD BJCA BJCB BJCC BJCD BJEA BJEB BJEC BJED CJAA CJAB CJAC CJAD CJBA CJBB CJBC CJBD CJCA CJCB CJCC CJCD CJEA CJEB CJEC CJED DJAA DJAB DJAC DJAD DJBA DJBB DJBC DJBD DJCA DJCB DJCC DJCD DJEA DJEB DJEC DJED EJAA EJAB EJAC EJAD EJBA EJBB EJBC EJBD EJCA EJCB EJCC EJCD EJEA EJEB EJEC EJED FJAA FJAB FJAC FJAD FJBA FJBB FJBC FJBD FJCA FJCB FJCC FJCD FJEA FJEB FJEC FJED GJAA GJAB GJAC GJAD GJBA GJBB GJBC GJBD GJCA GJCB GJCC GJCD GJEA GJEB GJEC GJED HJAA HJAB HJAC HJAD HJBA HJBB HJBC HJBD HJCA HJCB HJCC HJCD HJEA HJEB HJEC HJED IJAA IJAB IJAC IJAD IJBA IJBB IJBC IJBD IJCA IJCB IJCC IJCD IJEA IJEB IJEC IJED JJAA JJAB JJAC JJAD JJBA JJBB JJBC JJBD JJCA JJCB JJCC JJCD JJEA JJEB JJEC JJED AKAA AKAB AKAC AKEA AKEB AKEC BKAA BKAB BKAC BKAD BKBA BKBB BKBC BKBD BKCA BKCB BKCC BKEA BKEB BKEC BKED CKAA CKAB CKAC CKAD CKBA CKBB CKBC CKBD CKCA CKCB CKCC CKCD CKEA CKEB CKEC CKED DKAA DKAB DKAC DKAD DKBA DKBB DKBC DKBD DKCA DKCB DKCC DKCD DKEA DKEB DKEC DKED EKAA EKAB EKAC EKAD EKBA EKBB EKBC EKBD EKCA EKCB EKCC EKCD EKEA EKEB EKEC EKED FKAA FKAB FKAC FKAD FKBA FKBB FKBC FKBD FKCA FKCB FKCC FKCD FKEA FKEB FKEC FKED GKAA GKAB GKAC GKAD GKBA GKBB GKBC GKBD GKCA GKCB GKCC GKCD GKEA GKEB GKEC GKED HKAA HKAB HKAC HKAD HKBA HKBB HKBC HKBD HKCA HKCB HKCC HKCD HKEA HKEB HKEC HKED IKAA IKAB IKAC IKAD IKBA IKBB IKBC IKBD IKCA IKCB IKCC IKCD IKEA IKEB IKEC IKED".split()

TRANCH = None
def get_zinc_tranch():
    """Get a random ZINC tranch."""
    global TRANCH
    if TRANCH is None:
        tranch_id = ZINC_TRANCHES[np.random.randint(len(ZINC_TRANCHES))]
        smi_file = f"http://files.docking.org/2D/{tranch_id[:2]}/{tranch_id}.smi"
        TRANCH = requests.get(smi_file).text.splitlines()[1:]
    return TRANCH

def get_random_zinc_smiles():
    """Get a random ZINC SMILES string"""
    lines = get_zinc_tranch()
    return lines[np.random.randint(len(lines))].split()[0]